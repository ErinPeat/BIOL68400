{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [],
   "source": [
    "data = pd.read_csv('antibiotics_data.csv', delimiter=',', header = 0 ,  na_values = ['0', '.'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            date      id                                  name  y_items  \\\n",
      "0     2014-10-01  P84659                 DR HUSSAIN'S PRACTICE     84.0   \n",
      "1     2014-10-01  P84605                    FERNCLOUGH SURGERY     33.0   \n",
      "2     2014-10-01  Y02520              SIMPSON MEDICAL PRACTICE     74.0   \n",
      "3     2014-10-01  P84623               ALEESHAN MEDICAL CENTRE     25.0   \n",
      "4     2014-10-01  P84683                     THE DOC'S SURGERY    152.0   \n",
      "5     2014-10-01  P84039              THE RANGE MEDICAL CENTRE    211.0   \n",
      "6     2014-10-01  P84639            FALLOWFIELD MEDICAL CENTRE     56.0   \n",
      "7     2014-10-01  P84005                   THE VALLANCE CENTRE    203.0   \n",
      "8     2014-10-01  P84677  DIDSBURY MEDICAL CENTRE- DR ASHWORTH    161.0   \n",
      "9     2014-10-01  P84616                    MANCHESTER MEDICAL    190.0   \n",
      "10    2014-10-01  P84630             THE ARCH MEDICAL PRACTICE    372.0   \n",
      "11    2014-10-01  P84072        THE ROBERT DARBISHIRE PRACTICE    610.0   \n",
      "12    2014-10-01  P84068              CHORLTON FAMILY PRACTICE    306.0   \n",
      "13    2014-10-01  P84650                THE ALEXANDRA PRACTICE    199.0   \n",
      "14    2014-10-01  P84669            CORNBROOK MEDICAL PRACTICE    348.0   \n",
      "15    2014-10-01  P84034                 BARLOW MEDICAL CENTRE    500.0   \n",
      "16    2014-10-01  P84035                  BODEY MEDICAL CENTRE    631.0   \n",
      "17    2014-10-01  P84010          THE BORCHARDT MEDICAL CENTRE    423.0   \n",
      "18    2014-10-01  P84009            AILSA CRAIG MEDICAL CENTRE    357.0   \n",
      "19    2014-10-01  P84689            LONGSIGHT MEDICAL PRACTICE    182.0   \n",
      "20    2014-10-01  P84635                THE WHITSWOOD PRACTICE    135.0   \n",
      "21    2014-10-01  P84038                      ASHVILLE SURGERY    306.0   \n",
      "22    2014-10-01  P84061           BROOKLANDS MEDICAL PRACTICE    218.0   \n",
      "23    2014-10-01  P84027             WEST POINT MEDICAL CENTRE    296.0   \n",
      "24    2014-10-01  P84026         DICKENSON ROAD MEDICAL CENTRE    260.0   \n",
      "25    2014-10-01  P84017               LADYBARN GROUP PRACTICE    427.0   \n",
      "26    2014-10-01  P84665               AL-SHIFA MEDICAL CENTRE    116.0   \n",
      "27    2014-10-01  P84037              DR CUNNINGHAM & PARTNERS    297.0   \n",
      "28    2014-10-01  P84053                      ASHCROFT SURGERY    357.0   \n",
      "29    2014-10-01  P84676          OSWALD ROAD MEDICAL PRACTICE    199.0   \n",
      "...          ...     ...                                   ...      ...   \n",
      "5395  2019-09-01  P84061           BROOKLANDS MEDICAL PRACTICE    262.0   \n",
      "5396  2019-09-01  P84012             NORTHENDEN GROUP PRACTICE    433.0   \n",
      "5397  2019-09-01  P84067              HAZELDENE MEDICAL CENTRE    304.0   \n",
      "5398  2019-09-01  P84062                     BROOKDALE SURGERY    106.0   \n",
      "5399  2019-09-01  P84032                   DRS HANIF & BANNURU    285.0   \n",
      "5400  2019-09-01  P84040                 CONRAN MEDICAL CENTRE    311.0   \n",
      "5401  2019-09-01  P84043             CORNISHWAY GROUP PRACTICE    427.0   \n",
      "5402  2019-09-01  P84663             THE NEVILLE FAMILY CENTRE    208.0   \n",
      "5403  2019-09-01  P84021             THE MAPLES MEDICAL CENTRE    409.0   \n",
      "5404  2019-09-01  P84672            WOODLANDS MEDICAL PRACTICE    156.0   \n",
      "5405  2019-09-01  P84047          DROYLSDEN RD FAMILY PRACTICE    210.0   \n",
      "5406  2019-09-01  P84644                      PARKSIDE SURGERY    266.0   \n",
      "5407  2019-09-01  Y01695                      MP VICTORIA MILL    137.0   \n",
      "5408  2019-09-01  P84637                    DR KHAN'S PRACTICE    144.0   \n",
      "5409  2019-09-01  P84690               DAM HEAD MEDICAL CENTRE    150.0   \n",
      "5410  2019-09-01  P84059            LIME SQUARE MEDICAL CENTRE    337.0   \n",
      "5411  2019-09-01  P84025            ST GEORGE'S MEDICAL CENTRE    391.0   \n",
      "5412  2019-09-01  P84651        NORTHERN MOOR MEDICAL PRACTICE    235.0   \n",
      "5413  2019-09-01  P84054           WHITLEY ROAD MEDICAL CENTRE    378.0   \n",
      "5414  2019-09-01  P84028                 GORTON MEDICAL CENTRE    502.0   \n",
      "5415  2019-09-01  P84048               TREGENNA GROUP PRACTICE    388.0   \n",
      "5416  2019-09-01  P84049             THE AVENUE MEDICAL CENTRE    626.0   \n",
      "5417  2019-09-01  P84045               THE PARK MEDICAL CENTRE    329.0   \n",
      "5418  2019-09-01  P84024              BOWLAND MEDICAL PRACTICE    549.0   \n",
      "5419  2019-09-01  P84055                    MERSEYBANK SURGERY    192.0   \n",
      "5420  2019-09-01  P84029             BENCHILL MEDICAL PRACTICE    689.0   \n",
      "5421  2019-09-01  P84033                 BEACON MEDICAL CENTRE    292.0   \n",
      "5422  2019-09-01  P84014                   RK MEDICAL PRACTICE    381.0   \n",
      "5423  2019-09-01  Y02849                    CITY HEALTH CENTRE   1148.0   \n",
      "5424  2019-09-01  Y02890                           HAWTHORN MC    532.0   \n",
      "\n",
      "      y_actual_cost  total_list_size  \n",
      "0            220.37              NaN  \n",
      "1             94.70           2154.0  \n",
      "2            853.44           4720.0  \n",
      "3             46.11           1297.0  \n",
      "4            805.43           6256.0  \n",
      "5            922.32           8228.0  \n",
      "6            356.64           2111.0  \n",
      "7            919.79           7223.0  \n",
      "8            707.78           5574.0  \n",
      "9            770.03           6529.0  \n",
      "10          2089.69          12381.0  \n",
      "11          3134.14          19985.0  \n",
      "12          2847.20           9847.0  \n",
      "13          1049.97           5909.0  \n",
      "14          1571.15           9992.0  \n",
      "15          2493.03          13424.0  \n",
      "16          2910.08          16620.0  \n",
      "17          1873.21          11108.0  \n",
      "18          2063.74           9342.0  \n",
      "19          1095.15           4730.0  \n",
      "20           680.15           3488.0  \n",
      "21          1856.54           7899.0  \n",
      "22          1248.33           5479.0  \n",
      "23          1290.33           7247.0  \n",
      "24          1087.36           6303.0  \n",
      "25          1913.21          10222.0  \n",
      "26           388.59           2749.0  \n",
      "27          1153.51           6825.0  \n",
      "28          1732.05           8036.0  \n",
      "29          1262.07           4452.0  \n",
      "...             ...              ...  \n",
      "5395        1851.15           6071.0  \n",
      "5396        2385.54          10009.0  \n",
      "5397        1440.74           6831.0  \n",
      "5398         892.02           2377.0  \n",
      "5399        1155.97           6346.0  \n",
      "5400        1586.82           6879.0  \n",
      "5401        2586.58           9386.0  \n",
      "5402        1030.27           4571.0  \n",
      "5403        2089.61           8708.0  \n",
      "5404         568.95           3228.0  \n",
      "5405        1451.89           4337.0  \n",
      "5406        1466.78           5469.0  \n",
      "5407         466.19           2747.0  \n",
      "5408         572.21           2814.0  \n",
      "5409         446.26           2778.0  \n",
      "5410        1868.99           6203.0  \n",
      "5411        2137.95           7126.0  \n",
      "5412        1235.94           4237.0  \n",
      "5413        1754.06           6735.0  \n",
      "5414        2250.32           8608.0  \n",
      "5415        1705.88           6607.0  \n",
      "5416        2489.06          10472.0  \n",
      "5417        1938.35           5326.0  \n",
      "5418        2034.37           7849.0  \n",
      "5419        1114.88           2720.0  \n",
      "5420        3263.41           9668.0  \n",
      "5421         864.41           4084.0  \n",
      "5422        1889.63           4930.0  \n",
      "5423        3886.22          13387.0  \n",
      "5424        2288.94           5281.0  \n",
      "\n",
      "[5425 rows x 6 columns]\n"
     ]
    }
   ],
   "source": [
    "print (data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6 entries were deleted due to patient population not reported for this incidence, but GP data may exist in rest of the dataset\n"
     ]
    }
   ],
   "source": [
    "null_values = pd.notnull(data[\"total_list_size\"])\n",
    "zeroes_list = 0\n",
    "for bools in null_values:\n",
    "    if bools == False:\n",
    "        zeroes_list = zeroes_list + 1\n",
    "print(zeroes_list , 'entries were deleted due to patient population not reported for this incidence, but GP data may exist in rest of the dataset')\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            date      id                                  name  y_items  \\\n",
      "1     2014-10-01  P84605                    FERNCLOUGH SURGERY     33.0   \n",
      "2     2014-10-01  Y02520              SIMPSON MEDICAL PRACTICE     74.0   \n",
      "3     2014-10-01  P84623               ALEESHAN MEDICAL CENTRE     25.0   \n",
      "4     2014-10-01  P84683                     THE DOC'S SURGERY    152.0   \n",
      "5     2014-10-01  P84039              THE RANGE MEDICAL CENTRE    211.0   \n",
      "6     2014-10-01  P84639            FALLOWFIELD MEDICAL CENTRE     56.0   \n",
      "7     2014-10-01  P84005                   THE VALLANCE CENTRE    203.0   \n",
      "8     2014-10-01  P84677  DIDSBURY MEDICAL CENTRE- DR ASHWORTH    161.0   \n",
      "9     2014-10-01  P84616                    MANCHESTER MEDICAL    190.0   \n",
      "10    2014-10-01  P84630             THE ARCH MEDICAL PRACTICE    372.0   \n",
      "11    2014-10-01  P84072        THE ROBERT DARBISHIRE PRACTICE    610.0   \n",
      "12    2014-10-01  P84068              CHORLTON FAMILY PRACTICE    306.0   \n",
      "13    2014-10-01  P84650                THE ALEXANDRA PRACTICE    199.0   \n",
      "14    2014-10-01  P84669            CORNBROOK MEDICAL PRACTICE    348.0   \n",
      "15    2014-10-01  P84034                 BARLOW MEDICAL CENTRE    500.0   \n",
      "16    2014-10-01  P84035                  BODEY MEDICAL CENTRE    631.0   \n",
      "17    2014-10-01  P84010          THE BORCHARDT MEDICAL CENTRE    423.0   \n",
      "18    2014-10-01  P84009            AILSA CRAIG MEDICAL CENTRE    357.0   \n",
      "19    2014-10-01  P84689            LONGSIGHT MEDICAL PRACTICE    182.0   \n",
      "20    2014-10-01  P84635                THE WHITSWOOD PRACTICE    135.0   \n",
      "21    2014-10-01  P84038                      ASHVILLE SURGERY    306.0   \n",
      "22    2014-10-01  P84061           BROOKLANDS MEDICAL PRACTICE    218.0   \n",
      "23    2014-10-01  P84027             WEST POINT MEDICAL CENTRE    296.0   \n",
      "24    2014-10-01  P84026         DICKENSON ROAD MEDICAL CENTRE    260.0   \n",
      "25    2014-10-01  P84017               LADYBARN GROUP PRACTICE    427.0   \n",
      "26    2014-10-01  P84665               AL-SHIFA MEDICAL CENTRE    116.0   \n",
      "27    2014-10-01  P84037              DR CUNNINGHAM & PARTNERS    297.0   \n",
      "28    2014-10-01  P84053                      ASHCROFT SURGERY    357.0   \n",
      "29    2014-10-01  P84676          OSWALD ROAD MEDICAL PRACTICE    199.0   \n",
      "30    2014-10-01  P84611                  DR CHIU, KOH AND GAN    266.0   \n",
      "...          ...     ...                                   ...      ...   \n",
      "5395  2019-09-01  P84061           BROOKLANDS MEDICAL PRACTICE    262.0   \n",
      "5396  2019-09-01  P84012             NORTHENDEN GROUP PRACTICE    433.0   \n",
      "5397  2019-09-01  P84067              HAZELDENE MEDICAL CENTRE    304.0   \n",
      "5398  2019-09-01  P84062                     BROOKDALE SURGERY    106.0   \n",
      "5399  2019-09-01  P84032                   DRS HANIF & BANNURU    285.0   \n",
      "5400  2019-09-01  P84040                 CONRAN MEDICAL CENTRE    311.0   \n",
      "5401  2019-09-01  P84043             CORNISHWAY GROUP PRACTICE    427.0   \n",
      "5402  2019-09-01  P84663             THE NEVILLE FAMILY CENTRE    208.0   \n",
      "5403  2019-09-01  P84021             THE MAPLES MEDICAL CENTRE    409.0   \n",
      "5404  2019-09-01  P84672            WOODLANDS MEDICAL PRACTICE    156.0   \n",
      "5405  2019-09-01  P84047          DROYLSDEN RD FAMILY PRACTICE    210.0   \n",
      "5406  2019-09-01  P84644                      PARKSIDE SURGERY    266.0   \n",
      "5407  2019-09-01  Y01695                      MP VICTORIA MILL    137.0   \n",
      "5408  2019-09-01  P84637                    DR KHAN'S PRACTICE    144.0   \n",
      "5409  2019-09-01  P84690               DAM HEAD MEDICAL CENTRE    150.0   \n",
      "5410  2019-09-01  P84059            LIME SQUARE MEDICAL CENTRE    337.0   \n",
      "5411  2019-09-01  P84025            ST GEORGE'S MEDICAL CENTRE    391.0   \n",
      "5412  2019-09-01  P84651        NORTHERN MOOR MEDICAL PRACTICE    235.0   \n",
      "5413  2019-09-01  P84054           WHITLEY ROAD MEDICAL CENTRE    378.0   \n",
      "5414  2019-09-01  P84028                 GORTON MEDICAL CENTRE    502.0   \n",
      "5415  2019-09-01  P84048               TREGENNA GROUP PRACTICE    388.0   \n",
      "5416  2019-09-01  P84049             THE AVENUE MEDICAL CENTRE    626.0   \n",
      "5417  2019-09-01  P84045               THE PARK MEDICAL CENTRE    329.0   \n",
      "5418  2019-09-01  P84024              BOWLAND MEDICAL PRACTICE    549.0   \n",
      "5419  2019-09-01  P84055                    MERSEYBANK SURGERY    192.0   \n",
      "5420  2019-09-01  P84029             BENCHILL MEDICAL PRACTICE    689.0   \n",
      "5421  2019-09-01  P84033                 BEACON MEDICAL CENTRE    292.0   \n",
      "5422  2019-09-01  P84014                   RK MEDICAL PRACTICE    381.0   \n",
      "5423  2019-09-01  Y02849                    CITY HEALTH CENTRE   1148.0   \n",
      "5424  2019-09-01  Y02890                           HAWTHORN MC    532.0   \n",
      "\n",
      "      y_actual_cost  total_list_size  \n",
      "1             94.70           2154.0  \n",
      "2            853.44           4720.0  \n",
      "3             46.11           1297.0  \n",
      "4            805.43           6256.0  \n",
      "5            922.32           8228.0  \n",
      "6            356.64           2111.0  \n",
      "7            919.79           7223.0  \n",
      "8            707.78           5574.0  \n",
      "9            770.03           6529.0  \n",
      "10          2089.69          12381.0  \n",
      "11          3134.14          19985.0  \n",
      "12          2847.20           9847.0  \n",
      "13          1049.97           5909.0  \n",
      "14          1571.15           9992.0  \n",
      "15          2493.03          13424.0  \n",
      "16          2910.08          16620.0  \n",
      "17          1873.21          11108.0  \n",
      "18          2063.74           9342.0  \n",
      "19          1095.15           4730.0  \n",
      "20           680.15           3488.0  \n",
      "21          1856.54           7899.0  \n",
      "22          1248.33           5479.0  \n",
      "23          1290.33           7247.0  \n",
      "24          1087.36           6303.0  \n",
      "25          1913.21          10222.0  \n",
      "26           388.59           2749.0  \n",
      "27          1153.51           6825.0  \n",
      "28          1732.05           8036.0  \n",
      "29          1262.07           4452.0  \n",
      "30          1560.09           5822.0  \n",
      "...             ...              ...  \n",
      "5395        1851.15           6071.0  \n",
      "5396        2385.54          10009.0  \n",
      "5397        1440.74           6831.0  \n",
      "5398         892.02           2377.0  \n",
      "5399        1155.97           6346.0  \n",
      "5400        1586.82           6879.0  \n",
      "5401        2586.58           9386.0  \n",
      "5402        1030.27           4571.0  \n",
      "5403        2089.61           8708.0  \n",
      "5404         568.95           3228.0  \n",
      "5405        1451.89           4337.0  \n",
      "5406        1466.78           5469.0  \n",
      "5407         466.19           2747.0  \n",
      "5408         572.21           2814.0  \n",
      "5409         446.26           2778.0  \n",
      "5410        1868.99           6203.0  \n",
      "5411        2137.95           7126.0  \n",
      "5412        1235.94           4237.0  \n",
      "5413        1754.06           6735.0  \n",
      "5414        2250.32           8608.0  \n",
      "5415        1705.88           6607.0  \n",
      "5416        2489.06          10472.0  \n",
      "5417        1938.35           5326.0  \n",
      "5418        2034.37           7849.0  \n",
      "5419        1114.88           2720.0  \n",
      "5420        3263.41           9668.0  \n",
      "5421         864.41           4084.0  \n",
      "5422        1889.63           4930.0  \n",
      "5423        3886.22          13387.0  \n",
      "5424        2288.94           5281.0  \n",
      "\n",
      "[5419 rows x 6 columns]\n"
     ]
    }
   ],
   "source": [
    "new_data = data[null_values]\n",
    "print (new_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            date      id                                  name  y_items  \\\n",
      "1     2014-10-01  P84605                    FERNCLOUGH SURGERY     33.0   \n",
      "2     2014-10-01  Y02520              SIMPSON MEDICAL PRACTICE     74.0   \n",
      "3     2014-10-01  P84623               ALEESHAN MEDICAL CENTRE     25.0   \n",
      "4     2014-10-01  P84683                     THE DOC'S SURGERY    152.0   \n",
      "5     2014-10-01  P84039              THE RANGE MEDICAL CENTRE    211.0   \n",
      "6     2014-10-01  P84639            FALLOWFIELD MEDICAL CENTRE     56.0   \n",
      "7     2014-10-01  P84005                   THE VALLANCE CENTRE    203.0   \n",
      "8     2014-10-01  P84677  DIDSBURY MEDICAL CENTRE- DR ASHWORTH    161.0   \n",
      "9     2014-10-01  P84616                    MANCHESTER MEDICAL    190.0   \n",
      "10    2014-10-01  P84630             THE ARCH MEDICAL PRACTICE    372.0   \n",
      "11    2014-10-01  P84072        THE ROBERT DARBISHIRE PRACTICE    610.0   \n",
      "12    2014-10-01  P84068              CHORLTON FAMILY PRACTICE    306.0   \n",
      "13    2014-10-01  P84650                THE ALEXANDRA PRACTICE    199.0   \n",
      "14    2014-10-01  P84669            CORNBROOK MEDICAL PRACTICE    348.0   \n",
      "15    2014-10-01  P84034                 BARLOW MEDICAL CENTRE    500.0   \n",
      "16    2014-10-01  P84035                  BODEY MEDICAL CENTRE    631.0   \n",
      "17    2014-10-01  P84010          THE BORCHARDT MEDICAL CENTRE    423.0   \n",
      "18    2014-10-01  P84009            AILSA CRAIG MEDICAL CENTRE    357.0   \n",
      "19    2014-10-01  P84689            LONGSIGHT MEDICAL PRACTICE    182.0   \n",
      "20    2014-10-01  P84635                THE WHITSWOOD PRACTICE    135.0   \n",
      "21    2014-10-01  P84038                      ASHVILLE SURGERY    306.0   \n",
      "22    2014-10-01  P84061           BROOKLANDS MEDICAL PRACTICE    218.0   \n",
      "23    2014-10-01  P84027             WEST POINT MEDICAL CENTRE    296.0   \n",
      "24    2014-10-01  P84026         DICKENSON ROAD MEDICAL CENTRE    260.0   \n",
      "25    2014-10-01  P84017               LADYBARN GROUP PRACTICE    427.0   \n",
      "26    2014-10-01  P84665               AL-SHIFA MEDICAL CENTRE    116.0   \n",
      "27    2014-10-01  P84037              DR CUNNINGHAM & PARTNERS    297.0   \n",
      "28    2014-10-01  P84053                      ASHCROFT SURGERY    357.0   \n",
      "29    2014-10-01  P84676          OSWALD ROAD MEDICAL PRACTICE    199.0   \n",
      "30    2014-10-01  P84611                  DR CHIU, KOH AND GAN    266.0   \n",
      "...          ...     ...                                   ...      ...   \n",
      "5395  2019-09-01  P84061           BROOKLANDS MEDICAL PRACTICE    262.0   \n",
      "5396  2019-09-01  P84012             NORTHENDEN GROUP PRACTICE    433.0   \n",
      "5397  2019-09-01  P84067              HAZELDENE MEDICAL CENTRE    304.0   \n",
      "5398  2019-09-01  P84062                     BROOKDALE SURGERY    106.0   \n",
      "5399  2019-09-01  P84032                   DRS HANIF & BANNURU    285.0   \n",
      "5400  2019-09-01  P84040                 CONRAN MEDICAL CENTRE    311.0   \n",
      "5401  2019-09-01  P84043             CORNISHWAY GROUP PRACTICE    427.0   \n",
      "5402  2019-09-01  P84663             THE NEVILLE FAMILY CENTRE    208.0   \n",
      "5403  2019-09-01  P84021             THE MAPLES MEDICAL CENTRE    409.0   \n",
      "5404  2019-09-01  P84672            WOODLANDS MEDICAL PRACTICE    156.0   \n",
      "5405  2019-09-01  P84047          DROYLSDEN RD FAMILY PRACTICE    210.0   \n",
      "5406  2019-09-01  P84644                      PARKSIDE SURGERY    266.0   \n",
      "5407  2019-09-01  Y01695                      MP VICTORIA MILL    137.0   \n",
      "5408  2019-09-01  P84637                    DR KHAN'S PRACTICE    144.0   \n",
      "5409  2019-09-01  P84690               DAM HEAD MEDICAL CENTRE    150.0   \n",
      "5410  2019-09-01  P84059            LIME SQUARE MEDICAL CENTRE    337.0   \n",
      "5411  2019-09-01  P84025            ST GEORGE'S MEDICAL CENTRE    391.0   \n",
      "5412  2019-09-01  P84651        NORTHERN MOOR MEDICAL PRACTICE    235.0   \n",
      "5413  2019-09-01  P84054           WHITLEY ROAD MEDICAL CENTRE    378.0   \n",
      "5414  2019-09-01  P84028                 GORTON MEDICAL CENTRE    502.0   \n",
      "5415  2019-09-01  P84048               TREGENNA GROUP PRACTICE    388.0   \n",
      "5416  2019-09-01  P84049             THE AVENUE MEDICAL CENTRE    626.0   \n",
      "5417  2019-09-01  P84045               THE PARK MEDICAL CENTRE    329.0   \n",
      "5418  2019-09-01  P84024              BOWLAND MEDICAL PRACTICE    549.0   \n",
      "5419  2019-09-01  P84055                    MERSEYBANK SURGERY    192.0   \n",
      "5420  2019-09-01  P84029             BENCHILL MEDICAL PRACTICE    689.0   \n",
      "5421  2019-09-01  P84033                 BEACON MEDICAL CENTRE    292.0   \n",
      "5422  2019-09-01  P84014                   RK MEDICAL PRACTICE    381.0   \n",
      "5423  2019-09-01  Y02849                    CITY HEALTH CENTRE   1148.0   \n",
      "5424  2019-09-01  Y02890                           HAWTHORN MC    532.0   \n",
      "\n",
      "      y_actual_cost  total_list_size  patients/1000  items_per_1000  \n",
      "1             94.70           2154.0          2.154       15.320334  \n",
      "2            853.44           4720.0          4.720       15.677966  \n",
      "3             46.11           1297.0          1.297       19.275251  \n",
      "4            805.43           6256.0          6.256       24.296675  \n",
      "5            922.32           8228.0          8.228       25.644142  \n",
      "6            356.64           2111.0          2.111       26.527712  \n",
      "7            919.79           7223.0          7.223       28.104666  \n",
      "8            707.78           5574.0          5.574       28.884105  \n",
      "9            770.03           6529.0          6.529       29.100934  \n",
      "10          2089.69          12381.0         12.381       30.046038  \n",
      "11          3134.14          19985.0         19.985       30.522892  \n",
      "12          2847.20           9847.0          9.847       31.075454  \n",
      "13          1049.97           5909.0          5.909       33.677441  \n",
      "14          1571.15           9992.0          9.992       34.827862  \n",
      "15          2493.03          13424.0         13.424       37.246722  \n",
      "16          2910.08          16620.0         16.620       37.966306  \n",
      "17          1873.21          11108.0         11.108       38.080663  \n",
      "18          2063.74           9342.0          9.342       38.214515  \n",
      "19          1095.15           4730.0          4.730       38.477801  \n",
      "20           680.15           3488.0          3.488       38.704128  \n",
      "21          1856.54           7899.0          7.899       38.739081  \n",
      "22          1248.33           5479.0          5.479       39.788283  \n",
      "23          1290.33           7247.0          7.247       40.844487  \n",
      "24          1087.36           6303.0          6.303       41.250198  \n",
      "25          1913.21          10222.0         10.222       41.772647  \n",
      "26           388.59           2749.0          2.749       42.197163  \n",
      "27          1153.51           6825.0          6.825       43.516484  \n",
      "28          1732.05           8036.0          8.036       44.425087  \n",
      "29          1262.07           4452.0          4.452       44.699012  \n",
      "30          1560.09           5822.0          5.822       45.688767  \n",
      "...             ...              ...            ...             ...  \n",
      "5395        1851.15           6071.0          6.071       43.155987  \n",
      "5396        2385.54          10009.0         10.009       43.261065  \n",
      "5397        1440.74           6831.0          6.831       44.503001  \n",
      "5398         892.02           2377.0          2.377       44.594026  \n",
      "5399        1155.97           6346.0          6.346       44.910180  \n",
      "5400        1586.82           6879.0          6.879       45.210060  \n",
      "5401        2586.58           9386.0          9.386       45.493288  \n",
      "5402        1030.27           4571.0          4.571       45.504266  \n",
      "5403        2089.61           8708.0          8.708       46.968305  \n",
      "5404         568.95           3228.0          3.228       48.327138  \n",
      "5405        1451.89           4337.0          4.337       48.420567  \n",
      "5406        1466.78           5469.0          5.469       48.637777  \n",
      "5407         466.19           2747.0          2.747       49.872588  \n",
      "5408         572.21           2814.0          2.814       51.172708  \n",
      "5409         446.26           2778.0          2.778       53.995680  \n",
      "5410        1868.99           6203.0          6.203       54.328551  \n",
      "5411        2137.95           7126.0          7.126       54.869492  \n",
      "5412        1235.94           4237.0          4.237       55.463772  \n",
      "5413        1754.06           6735.0          6.735       56.124722  \n",
      "5414        2250.32           8608.0          8.608       58.317844  \n",
      "5415        1705.88           6607.0          6.607       58.725594  \n",
      "5416        2489.06          10472.0         10.472       59.778457  \n",
      "5417        1938.35           5326.0          5.326       61.772437  \n",
      "5418        2034.37           7849.0          7.849       69.945216  \n",
      "5419        1114.88           2720.0          2.720       70.588235  \n",
      "5420        3263.41           9668.0          9.668       71.266032  \n",
      "5421         864.41           4084.0          4.084       71.498531  \n",
      "5422        1889.63           4930.0          4.930       77.281947  \n",
      "5423        3886.22          13387.0         13.387       85.754837  \n",
      "5424        2288.94           5281.0          5.281      100.738496  \n",
      "\n",
      "[5419 rows x 8 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/apps/anaconda/lib/python3.7/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  \"\"\"Entry point for launching an IPython kernel.\n"
     ]
    }
   ],
   "source": [
    "new_data['patients/1000'] = new_data['total_list_size'] / (1000)\n",
    "print(new_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            date      id                                  name  y_items  \\\n",
      "1     2014-10-01  P84605                    FERNCLOUGH SURGERY     33.0   \n",
      "2     2014-10-01  Y02520              SIMPSON MEDICAL PRACTICE     74.0   \n",
      "3     2014-10-01  P84623               ALEESHAN MEDICAL CENTRE     25.0   \n",
      "4     2014-10-01  P84683                     THE DOC'S SURGERY    152.0   \n",
      "5     2014-10-01  P84039              THE RANGE MEDICAL CENTRE    211.0   \n",
      "6     2014-10-01  P84639            FALLOWFIELD MEDICAL CENTRE     56.0   \n",
      "7     2014-10-01  P84005                   THE VALLANCE CENTRE    203.0   \n",
      "8     2014-10-01  P84677  DIDSBURY MEDICAL CENTRE- DR ASHWORTH    161.0   \n",
      "9     2014-10-01  P84616                    MANCHESTER MEDICAL    190.0   \n",
      "10    2014-10-01  P84630             THE ARCH MEDICAL PRACTICE    372.0   \n",
      "11    2014-10-01  P84072        THE ROBERT DARBISHIRE PRACTICE    610.0   \n",
      "12    2014-10-01  P84068              CHORLTON FAMILY PRACTICE    306.0   \n",
      "13    2014-10-01  P84650                THE ALEXANDRA PRACTICE    199.0   \n",
      "14    2014-10-01  P84669            CORNBROOK MEDICAL PRACTICE    348.0   \n",
      "15    2014-10-01  P84034                 BARLOW MEDICAL CENTRE    500.0   \n",
      "16    2014-10-01  P84035                  BODEY MEDICAL CENTRE    631.0   \n",
      "17    2014-10-01  P84010          THE BORCHARDT MEDICAL CENTRE    423.0   \n",
      "18    2014-10-01  P84009            AILSA CRAIG MEDICAL CENTRE    357.0   \n",
      "19    2014-10-01  P84689            LONGSIGHT MEDICAL PRACTICE    182.0   \n",
      "20    2014-10-01  P84635                THE WHITSWOOD PRACTICE    135.0   \n",
      "21    2014-10-01  P84038                      ASHVILLE SURGERY    306.0   \n",
      "22    2014-10-01  P84061           BROOKLANDS MEDICAL PRACTICE    218.0   \n",
      "23    2014-10-01  P84027             WEST POINT MEDICAL CENTRE    296.0   \n",
      "24    2014-10-01  P84026         DICKENSON ROAD MEDICAL CENTRE    260.0   \n",
      "25    2014-10-01  P84017               LADYBARN GROUP PRACTICE    427.0   \n",
      "26    2014-10-01  P84665               AL-SHIFA MEDICAL CENTRE    116.0   \n",
      "27    2014-10-01  P84037              DR CUNNINGHAM & PARTNERS    297.0   \n",
      "28    2014-10-01  P84053                      ASHCROFT SURGERY    357.0   \n",
      "29    2014-10-01  P84676          OSWALD ROAD MEDICAL PRACTICE    199.0   \n",
      "30    2014-10-01  P84611                  DR CHIU, KOH AND GAN    266.0   \n",
      "...          ...     ...                                   ...      ...   \n",
      "5395  2019-09-01  P84061           BROOKLANDS MEDICAL PRACTICE    262.0   \n",
      "5396  2019-09-01  P84012             NORTHENDEN GROUP PRACTICE    433.0   \n",
      "5397  2019-09-01  P84067              HAZELDENE MEDICAL CENTRE    304.0   \n",
      "5398  2019-09-01  P84062                     BROOKDALE SURGERY    106.0   \n",
      "5399  2019-09-01  P84032                   DRS HANIF & BANNURU    285.0   \n",
      "5400  2019-09-01  P84040                 CONRAN MEDICAL CENTRE    311.0   \n",
      "5401  2019-09-01  P84043             CORNISHWAY GROUP PRACTICE    427.0   \n",
      "5402  2019-09-01  P84663             THE NEVILLE FAMILY CENTRE    208.0   \n",
      "5403  2019-09-01  P84021             THE MAPLES MEDICAL CENTRE    409.0   \n",
      "5404  2019-09-01  P84672            WOODLANDS MEDICAL PRACTICE    156.0   \n",
      "5405  2019-09-01  P84047          DROYLSDEN RD FAMILY PRACTICE    210.0   \n",
      "5406  2019-09-01  P84644                      PARKSIDE SURGERY    266.0   \n",
      "5407  2019-09-01  Y01695                      MP VICTORIA MILL    137.0   \n",
      "5408  2019-09-01  P84637                    DR KHAN'S PRACTICE    144.0   \n",
      "5409  2019-09-01  P84690               DAM HEAD MEDICAL CENTRE    150.0   \n",
      "5410  2019-09-01  P84059            LIME SQUARE MEDICAL CENTRE    337.0   \n",
      "5411  2019-09-01  P84025            ST GEORGE'S MEDICAL CENTRE    391.0   \n",
      "5412  2019-09-01  P84651        NORTHERN MOOR MEDICAL PRACTICE    235.0   \n",
      "5413  2019-09-01  P84054           WHITLEY ROAD MEDICAL CENTRE    378.0   \n",
      "5414  2019-09-01  P84028                 GORTON MEDICAL CENTRE    502.0   \n",
      "5415  2019-09-01  P84048               TREGENNA GROUP PRACTICE    388.0   \n",
      "5416  2019-09-01  P84049             THE AVENUE MEDICAL CENTRE    626.0   \n",
      "5417  2019-09-01  P84045               THE PARK MEDICAL CENTRE    329.0   \n",
      "5418  2019-09-01  P84024              BOWLAND MEDICAL PRACTICE    549.0   \n",
      "5419  2019-09-01  P84055                    MERSEYBANK SURGERY    192.0   \n",
      "5420  2019-09-01  P84029             BENCHILL MEDICAL PRACTICE    689.0   \n",
      "5421  2019-09-01  P84033                 BEACON MEDICAL CENTRE    292.0   \n",
      "5422  2019-09-01  P84014                   RK MEDICAL PRACTICE    381.0   \n",
      "5423  2019-09-01  Y02849                    CITY HEALTH CENTRE   1148.0   \n",
      "5424  2019-09-01  Y02890                           HAWTHORN MC    532.0   \n",
      "\n",
      "      y_actual_cost  total_list_size  patients/1000  items_per_1000  \n",
      "1             94.70           2154.0          2.154       15.320334  \n",
      "2            853.44           4720.0          4.720       15.677966  \n",
      "3             46.11           1297.0          1.297       19.275251  \n",
      "4            805.43           6256.0          6.256       24.296675  \n",
      "5            922.32           8228.0          8.228       25.644142  \n",
      "6            356.64           2111.0          2.111       26.527712  \n",
      "7            919.79           7223.0          7.223       28.104666  \n",
      "8            707.78           5574.0          5.574       28.884105  \n",
      "9            770.03           6529.0          6.529       29.100934  \n",
      "10          2089.69          12381.0         12.381       30.046038  \n",
      "11          3134.14          19985.0         19.985       30.522892  \n",
      "12          2847.20           9847.0          9.847       31.075454  \n",
      "13          1049.97           5909.0          5.909       33.677441  \n",
      "14          1571.15           9992.0          9.992       34.827862  \n",
      "15          2493.03          13424.0         13.424       37.246722  \n",
      "16          2910.08          16620.0         16.620       37.966306  \n",
      "17          1873.21          11108.0         11.108       38.080663  \n",
      "18          2063.74           9342.0          9.342       38.214515  \n",
      "19          1095.15           4730.0          4.730       38.477801  \n",
      "20           680.15           3488.0          3.488       38.704128  \n",
      "21          1856.54           7899.0          7.899       38.739081  \n",
      "22          1248.33           5479.0          5.479       39.788283  \n",
      "23          1290.33           7247.0          7.247       40.844487  \n",
      "24          1087.36           6303.0          6.303       41.250198  \n",
      "25          1913.21          10222.0         10.222       41.772647  \n",
      "26           388.59           2749.0          2.749       42.197163  \n",
      "27          1153.51           6825.0          6.825       43.516484  \n",
      "28          1732.05           8036.0          8.036       44.425087  \n",
      "29          1262.07           4452.0          4.452       44.699012  \n",
      "30          1560.09           5822.0          5.822       45.688767  \n",
      "...             ...              ...            ...             ...  \n",
      "5395        1851.15           6071.0          6.071       43.155987  \n",
      "5396        2385.54          10009.0         10.009       43.261065  \n",
      "5397        1440.74           6831.0          6.831       44.503001  \n",
      "5398         892.02           2377.0          2.377       44.594026  \n",
      "5399        1155.97           6346.0          6.346       44.910180  \n",
      "5400        1586.82           6879.0          6.879       45.210060  \n",
      "5401        2586.58           9386.0          9.386       45.493288  \n",
      "5402        1030.27           4571.0          4.571       45.504266  \n",
      "5403        2089.61           8708.0          8.708       46.968305  \n",
      "5404         568.95           3228.0          3.228       48.327138  \n",
      "5405        1451.89           4337.0          4.337       48.420567  \n",
      "5406        1466.78           5469.0          5.469       48.637777  \n",
      "5407         466.19           2747.0          2.747       49.872588  \n",
      "5408         572.21           2814.0          2.814       51.172708  \n",
      "5409         446.26           2778.0          2.778       53.995680  \n",
      "5410        1868.99           6203.0          6.203       54.328551  \n",
      "5411        2137.95           7126.0          7.126       54.869492  \n",
      "5412        1235.94           4237.0          4.237       55.463772  \n",
      "5413        1754.06           6735.0          6.735       56.124722  \n",
      "5414        2250.32           8608.0          8.608       58.317844  \n",
      "5415        1705.88           6607.0          6.607       58.725594  \n",
      "5416        2489.06          10472.0         10.472       59.778457  \n",
      "5417        1938.35           5326.0          5.326       61.772437  \n",
      "5418        2034.37           7849.0          7.849       69.945216  \n",
      "5419        1114.88           2720.0          2.720       70.588235  \n",
      "5420        3263.41           9668.0          9.668       71.266032  \n",
      "5421         864.41           4084.0          4.084       71.498531  \n",
      "5422        1889.63           4930.0          4.930       77.281947  \n",
      "5423        3886.22          13387.0         13.387       85.754837  \n",
      "5424        2288.94           5281.0          5.281      100.738496  \n",
      "\n",
      "[5419 rows x 8 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/apps/anaconda/lib/python3.7/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  \"\"\"Entry point for launching an IPython kernel.\n"
     ]
    }
   ],
   "source": [
    "new_data['items_per_1000'] = new_data['y_items'] / new_data['patients/1000']\n",
    "print(new_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_by_gp = new_data.groupby(['name'])\n",
    "#data_by_gp.first()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "pandas.core.groupby.generic.DataFrameGroupBy"
      ]
     },
     "execution_count": 69,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(data_by_gp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "pandas.core.frame.DataFrame"
      ]
     },
     "execution_count": 70,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(new_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
